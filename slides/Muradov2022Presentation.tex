\documentclass{beamer}
\beamertemplatenavigationsymbolsempty
\usecolortheme{beaver}
\setbeamertemplate{blocks}[rounded=true, shadow=true]
\setbeamertemplate{footline}[page number]
%
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage{amssymb,amsfonts,amsmath,mathtext}
\usepackage{subfig}
\usepackage[all]{xy} % xy package for diagrams
\usepackage{array}
\usepackage{multicol}% many columns in slide
\usepackage{hyperref}% urls
\usepackage{hhline}%tables
% Your figures are here:
\graphicspath{ {fig/} {../fig/} }

%----------------------------------------------------------------------------------------------------------
\title[\hbox to 56mm{Интерпретируемые CNN}]{Выбор интерпретируемых \\ сверточных моделей глубокого обучения}
\author[Т.\,Р. Мурадов]{Тимур Русланович Мурадов}
\institute{Московский физико-технический институт}
\date{\footnotesize
\par\smallskip\emph{Курс:} Моя первая научная статья\par (В.\,В.~Стрижов)/Группа Б05-907б
\par\smallskip\emph{Консультанты:} О.~Бахтеев, К.~Яковлев
\par\bigskip\small 2022}
%----------------------------------------------------------------------------------------------------------
\begin{document}
%----------------------------------------------------------------------------------------------------------
\begin{frame}
\thispagestyle{empty}
\maketitle
\end{frame}
%-----------------------------------------------------------------------------------------------------
\begin{frame}{Цель исследования}
	\begin{alertblock}{Задача}
	Выбор интерпретируемой сверточной нейронной сети.
	\end{alertblock}

	\begin{alertblock}{Проблема}
	Высокая сложность интерпретации сверточных нейронных сетей.
	\end{alertblock}

	\begin{alertblock}{Решение}
	Адаптация метода OpenBox для работы со сверточными нейронными сетями.
	\end{alertblock}

\end{frame}
%-----------------------------------------------------------------------------------------------------
\begin{frame}{Интерпретируемость изображений}

\begin{columns}[c]
\column{0.5\textwidth}
\includegraphics[width=0.75\textwidth]{../fig/example.png}
\column{0.5\textwidth}
\includegraphics[width=0.75\textwidth]{../fig/example_Lime.png}
\end{columns}

\bigskip
Выделение наиболее важных {\color{red}признаков} для изображений подразумевает собой подсветку {\color{red}формы} объекта соответствующего класса. 
\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{Литература}
\begin{enumerate}
	\item Marco Tulio Ribeiro, Sameer Singh, and Carlos Guestrin. Why should i trust you?: Explaining the
predictions of any classifier, 2016.
	\item Scott Lundberg and Su-In Lee. A unified approach to interpreting model predictions, 2017.
	\item Lingyang Chu, Xia Hu, Juhua Hu, Lanjun Wang, and Jian Pei. Exact and consistent interpretation for
piecewise linear neural networks: A closed form solution, 2019.
	\item Han Xiao, Kashif Rasul, and Roland Vollgraf. Fashion-mnist: a novel image dataset for benchmarking
machine learning algorithms, 2017.
\end{enumerate}
\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{Постановка задачи: модель и задача оптимизации}
Задана выборка $\mathbf{x} \in \mathbf{X}$, где $\mathbf{X} \in \mathbb{R}^m$. Вектор меток классов $\mathbf{y} \in \{1, 2, ... k\}$ --- заданное конечное множество классов.

Модель $\mathbf{f}(\mathbf{X}, \mathbf{w})$ --- сверточная нейронная сеть, это суперпозиция подмоделей $\mathbf{f_1} \circ \mathbf{f_2} \dots \mathbf{f_n}$.

Функции $\mathbf{f_i}$ --- слои нейронной сети, это одни из функций: линейные, свертки, операции побатчевой нормализации или пулинги.

В модели $\mathbf{f}(\mathbf{X}, \mathbf{w})$ оптимизируется функция кросс-энтропии $\mathcal{L}(\mathbf{g}, \mathbf{y})$, $\mathbf{g}$ --- функция softmax, $\mathbf{g}$: $\mathbb{R}^m \to \{1,\dots,k\}$, на выходе предсказанное распределение вероятности соответствия объектов классам.

$$\mathbf{g}(\mathbf{x})_i = \frac{\text{exp}(\mathbf{x_i})}{\Sigma_j \text{exp}(\mathbf{x_j})}.$$
$$\mathcal{L} = -\Sigma_i \mathbf{y}_i \log \mathbf{g}(\mathbf{x})_i \to \max.$$

\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{Постановка задачи: требования к модели}

Модель должна удовлетворять двум требованиям к интерпретируемости: $\textbf{точность}$ и $\textbf{консистентность}$.
\begin{enumerate}
   \item{Точность}:
    Близость предсказаний построенной модели к исходной.
	$$\|\mathbf{f}(\mathbf{X}, \mathbf{w}) - \mathbf{f}_{method}(\mathbf{X}, \mathbf{w})\| \to \min_{\mathbf{f_{method}}}$$    

 Где $\mathbf{f}$ - исходная модель, $\mathbf{f}_{method}$ - построенная модель.
    \item{Консистентность}:
    Близкие интерпретации для близких объектов выборки. $$\mathbf{x_i} \in U_\mathbf{\epsilon}(\mathbf{x_j}) \Longrightarrow \mathbf{f}_{method}(\mathbf{x_i}, \mathbf{w}) \in U_{\mathbf{f}_{method}(\mathbf{\epsilon}, \mathbf{w})}\mathbf{f}_{methood}(\mathbf{x_j}, \mathbf{w}).$$
\end{enumerate}
\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{Постановка задачи: критерий качества}

Критерием качества рассматривается точность предсказания класса объектов. Отличие оценок предсказаний для метода от истинных предсказаний, полученных из классификатора.

\end{frame}

%----------------------------------------------------------------------------------------------------------
\begin{frame}{Решение задачи интерпретации CNN}
Предлагается адаптация метода \textbf{OpenBox} работающего с  кусочно-линейными нейронными сетями. В нём модель представляется в виде набора интерпретируемых линейных классификаторов. Каждый из них определен на выпуклом многограннике. Метод обобщается на работу с более широким классом нейронных сетей: сверточными нейронными сетями.
\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{Линейность сверточных нейронных сетей}
\newtheorem{hypothesis}{Теорема}
\begin{hypothesis}
Слои сверточной нейронной сети: линейные, свертки, операции побатчевой нормализации, пулинги --- это линейные операции.
\end{hypothesis}

\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{Описание вычислительного эксперимента}

Фиксируется подвыборка размера 1000 из датасета \textbf{Fashion-MNIST}. Для каждого объекта генерируется похожий объект изменением случайного пикселя картинки.
\bigskip

Строится интерпретация для каждого объекта из подвыборки. Считается предсказание вероятности класса объекта, на самом объекте при помощи аппроксимации для базового метода \textbf{LIME} и на близком объекте для предложенного метода \textbf{OpenBox}.
\bigskip

Для методов строятся графики предсказания наиболее вероятного класса относительно предсказания классификатора исходной модели.
\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{Базовый эксперимент LIME}

 На графике представлена работа базового метода \textbf{LIME} по предсказанию класса объекта.

 \includegraphics[width=0.70\textwidth]{../fig/True_Lime.png}


График говорит о наличии значимых отклонений в работе базового пакета.

\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{Эксперимент по адаптации метода OpenBox}

 На графике представлена работа метода \textbf{OpenBox} по предсказанию класса на близких объектах.
 
 \includegraphics[width=0.70\textwidth]{../fig/True_OpenBox.png}


Заметим отсутствие больших скачков в предсказаниях на графике.

\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{Заключение}
    \begin{block}{Результаты}
    \begin{itemize}
        \item Предложена адаптация метода \textbf{OpenBox} в применении к работе со сверточными нейронными сетями.
        \item Доказана теорема о линейности слоев сверточных нейронных сетей.
        \item Проведен вычислительный эксперимент, по результатам которого показана более высокая точность полученного метода \textbf{OpenBox} по сравнению с базовым методом \textbf{LIME}
    \end{itemize}
    \end{block}
\end{frame}
%----------------------------------------------------------------------------------------------------------
\end{document} 
\end{frame}
%-----------------------------------------------------------------------------------------------------


\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{���������� ������}
\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{�������}
\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{�������������� �����������}
\end{frame}
%----------------------------------------------------------------------------------------------------------
\begin{frame}{����������}
\end{frame}
%----------------------------------------------------------------------------------------------------------
\end{document} 
